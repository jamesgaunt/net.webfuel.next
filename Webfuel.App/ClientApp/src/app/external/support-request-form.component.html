<div class="container">
  <div *ngIf="stage == 'input'">
    <form class="form" [formGroup]="form">

      <!-- Project Details-->
      <h2>Project Details</h2>
      <p>Please tell us more about your project. Please complete all required fields, selecting 'Not Known' if necessary.</p>
      <div class="flex">
        <div class="field is-12">
          <label class="label">Working title of the project</label>
          <input class="input" type="text" placeholder="required" formControlName="title" maxlength="1000" />
        </div>
        <div class="field is-6">
          <label class="label">Stage of application</label>
          <dropdown-select [dataSource]="staticDataCache.applicationStage" [freeTextControl]="form.controls.applicationStageFreeText" placeholder="required" formControlName="applicationStageId"></dropdown-select>
        </div>
        <div class="field is-6">
          <label class="label">Is this application for a fellowship?</label>
          <dropdown-select [dataSource]="staticDataCache.isFellowship" placeholder="required" formControlName="isFellowshipId"></dropdown-select>
        </div>
        <div class="field is-6">
          <label class="label">Proposed funding stream</label>
          <dropdown-select [dataSource]="staticDataCache.fundingStream" placeholder="required" formControlName="proposedFundingStreamId"></dropdown-select>
        </div>
        <div class="field is-6">
          <label class="label">Funding stream name / specialist call if known</label>
          <input class="input" type="text" placeholder="optional" formControlName="proposedFundingStreamName" maxlength="64" />
        </div>
        <div class="field is-6">
          <label class="label">Type of call</label>
          <dropdown-select [dataSource]="staticDataCache.fundingCallType" placeholder="required" formControlName="proposedFundingCallTypeId"></dropdown-select>
        </div>
        <div class="field is-6">
          <label class="label">Target submission date (if known)</label>
          <date-picker placeholder="optional" formControlName="targetSubmissionDate"></date-picker>
        </div>
        <div class="field is-6">
          <label class="label">Have your team members been consulted for support?</label>
          <dropdown-select [dataSource]="staticDataCache.isTeamMembersConsulted" placeholder="required" formControlName="isTeamMembersConsultedId"></dropdown-select>
        </div>
        <div class="field is-6">
          <label class="label">Has the application or similar been submitted to a funder before?</label>
          <dropdown-select [dataSource]="staticDataCache.isResubmission" placeholder="required" formControlName="isResubmissionId"></dropdown-select>
        </div>
        <div class="field is-6">
          <label class="label">How did you hear about our hub?</label>
          <dropdown-select [dataSource]="staticDataCache.howDidYouFindUs" [freeTextControl]="form.controls.howDidYouFindUsFreeText" placeholder="required" formControlName="howDidYouFindUsId"></dropdown-select>
        </div>
        <div class="field is-12">
          <label class="label">What is your (or the CIs)  experience of securing funding awards?</label>
          <textarea class="textarea" formControlName="experienceOfResearchAwards" placeholder="required" maxlength="1000"></textarea>
        </div>
        <div class="field is-12">
          <label class="label">
            Please add a brief description of your proposed study. Where possible include an outline of research question, aims, need and methods (you can also upload additional information below). [max 500 words]
          </label>
          <textarea class="textarea" formControlName="briefDescription" placeholder="required" maxlength="5000"></textarea>
        </div>
        <div class="field is-12">
          <label class="label">
            What support are you looking for from RSS?  Eg funding advice, methods advice, PPIE and EDI advice, CTU support, training in methods for grants?
          </label>
          <textarea class="textarea" formControlName="supportRequested" placeholder="required" maxlength="2000"></textarea>
        </div>
      </div>

      <!-- Team Contact Details -->
      <hr class="external-form-divider" />
      <h2>Contact Details</h2>
      <p>Please enter the details for the person we will contact regarding this project (this may or may not be the chief investigator).</p>
      <div class="flex">
        <div class="field is-4">
          <label class="label">Title</label>
          <dropdown-text-input placeholder="required" [dataSource]="staticDataCache.title" formControlName="teamContactTitle" />
        </div>
        <div class="field is-4">
          <label class="label">First name</label>
          <input class="input" type="text" placeholder="required" formControlName="teamContactFirstName" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">Last name</label>
          <input class="input" type="text" placeholder="required" formControlName="teamContactLastName" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">Email</label>
          <input class="input" type="text" placeholder="required" formControlName="teamContactEmail" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">Role in application</label>
          <dropdown-select [dataSource]="staticDataCache.researcherRole" [freeTextControl]="form.controls.teamContactRoleFreeText" placeholder="required" formControlName="teamContactRoleId"></dropdown-select>
        </div>
        <div class="field is-12">
          <div class="checkbox">
            <label><input type="checkbox" formControlName="teamContactMailingPermission" /> Please tick this checkbox to confirm you give us permission to contact you via email.</label>
          </div>
        </div>
        <div class="field is-12">
          <div class="checkbox">
            <label><input type="checkbox" formControlName="teamContactPrivacyStatementRead" /> Please tick this checkbox to confirm you have read our privacy statement [LINK REQUIRED].</label>
          </div>
        </div>
      </div>

      <!-- Lead Applicant Details -->
      <hr class="external-form-divider" />
      <h2>Chief Investigator Details</h2>
      <p>Please enter the details for the chief investigator for this project.</p>
      <div class="flex">
        <div class="field is-4">
          <label class="label">Title</label>
          <dropdown-text-input placeholder="required" [dataSource]="staticDataCache.title" formControlName="leadApplicantTitle" />
        </div>
        <div class="field is-4">
          <label class="label">First name</label>
          <input class="input" type="text" placeholder="required" formControlName="leadApplicantFirstName" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">Last name</label>
          <input class="input" type="text" placeholder="required" formControlName="leadApplicantLastName" maxlength="64" />
        </div>

        <div class="field is-4">
          <label class="label">Job Role</label>
          <input class="input" type="text" placeholder="required" formControlName="leadApplicantJobRole" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">Organisation Type</label>
          <dropdown-select [dataSource]="staticDataCache.researcherOrganisationType" placeholder="required" formControlName="leadApplicantOrganisationTypeId"></dropdown-select>
        </div>
        <div class="field is-4">
          <label class="label">Organisation</label>
          <input class="input" type="text" placeholder="required" formControlName="leadApplicantOrganisation" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">Department</label>
          <input class="input" type="text" placeholder="optional" formControlName="leadApplicantDepartment" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">ORCID</label>
          <input class="input" type="text" placeholder="optional" formControlName="leadApplicantORCID" maxlength="64" />
        </div>
        <div class="field is-4">
          <label class="label">
            Is the chief investigator an NHS employee seeking RSS support for the first time?Â 
          </label>
          <dropdown-select [dataSource]="staticDataCache.isLeadApplicantNHS" placeholder="required" formControlName="isLeadApplicantNHSId"></dropdown-select>
        </div>
      </div>

      <div class="flex">
        <div class="is-6">
          <h3>Work Address</h3>
          <div class="flex">
            <div class="field is-12">
              <label class="label">Line 1</label>
              <input class="input" type="text" placeholder="required" formControlName="leadApplicantAddressLine1" maxlength="64" />
            </div>
            <div class="field is-12">
              <label class="label">Line 2</label>
              <input class="input" type="text" placeholder="optional" formControlName="leadApplicantAddressLine2" maxlength="64" />
            </div>
            <div class="field is-12">
              <label class="label">Town/City</label>
              <input class="input" type="text" placeholder="required" formControlName="leadApplicantAddressTown" maxlength="64" />
            </div>
            <div class="field is-12">
              <label class="label">County</label>
              <input class="input" type="text" placeholder="required" formControlName="leadApplicantAddressCounty" maxlength="64" />
            </div>
            <div class="field is-12">
              <label class="label">Country</label>
              <input class="input" type="text" placeholder="required" formControlName="leadApplicantAddressCountry" maxlength="64" />
            </div>
            <div class="field is-12">
              <label class="label">Postcode</label>
              <input class="input" type="text" placeholder="required" formControlName="leadApplicantAddressPostcode" maxlength="64" />
            </div>
          </div>
        </div>
        <div class="is-6">
          <h3>Enthnicity, Diversity &amp; Inclusion</h3>
          <div class="flex">
            <div class="field is-12">
              <label class="label">Age Range</label>
              <dropdown-select [dataSource]="staticDataCache.ageRange" placeholder="required" formControlName="leadApplicantAgeRangeId"></dropdown-select>
            </div>
            <div class="field is-12">
              <label class="label">Gender</label>
              <dropdown-select [dataSource]="staticDataCache.gender" placeholder="required" formControlName="leadApplicantGenderId"></dropdown-select>
            </div>
            <div class="field is-12">
              <label class="label">Ethnicity</label>
              <dropdown-select [dataSource]="staticDataCache.ethnicity" placeholder="required" formControlName="leadApplicantEthnicityId"></dropdown-select>
            </div>
          </div>
        </div>
      </div>

      <hr class="external-form-divider" />
      <h2>Supporting Documents</h2>
      <p>If available, please provide copies of draft documentation, protocols, background information or feedback from any previous applications.</p>
      <file-input formControlName="files" [progress]="progress"></file-input>

      <hr class="external-form-divider" />
      <h2>Submit Your Application</h2>
      <p>You will receive an email confirming receipt of your application.</p>

      <div class="buttons">
        <button type="button" [disabled]="submitting" [class.processing]="submitting" class="button is-success" (click)="submit()">
          <span class="text">
            Submit Application
          </span>
          <span class="spin">
            <i class="far fa-spin fa-sync-alt"></i>
          </span>
        </button>
        &nbsp;
        <span class="text is-danger is-bold">{{ errorMessage }}</span>
      </div>
    </form>
  </div>
  <div *ngIf="stage == 'submitted'">
    <p>Thank you for submitting your support request. A member of our team will be in touch shortly.</p>
  </div>
  <div *ngIf="stage == 'error'">
    <div class="message is-danger">
      An error occured while attempting to submit your support request.
    </div>
  </div>
</div>
<br />

