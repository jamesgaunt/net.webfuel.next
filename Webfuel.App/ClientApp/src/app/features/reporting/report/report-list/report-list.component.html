<ul class="breadcrumbs">
  <li><a routerLink="/home">Home</a></li>
  <li><a routerLink="/reporting/report-list">Reports</a></li>
</ul>
<div class="container">
  <div class="columns">
    <div class="column">
      <h1 class="title">Reports</h1>
    </div>
    <div class="column">
      <div class="header-buttons">
        <button class="button is-success" (click)="add()">Add Report</button>
      </div>
    </div>
  </div>

  <div class="filter-form">
    <form class="form" [formGroup]="filterForm">
      <div class="flex">
        <div class="field is-6">
          <input class="input" type="text" formControlName="name" placeholder="Name" />
        </div>
        <div class="field is-3">
          <dropdown-select [dataSource]="reportGroupApi" placeholder="Report Group" formControlName="reportGroupId" [enableClear]="true" />
        </div>
        <div class="field is-3">
          <dropdown-select [items]="ownReportsOnlyItems" placeholder="optional" formControlName="ownReportsOnly" />
        </div>
        <div class="is-12 is-right">
          <button (click)="resetFilterForm()" class="button is-small">show all</button>
        </div>
      </div>
    </form>
  </div>

  <div class="card header">
    <div class="columns">
      <div class="column is-3">
        <h3 style="margin: 0">Report Name</h3>
      </div>
      <div class="column is-3">
        <h3 style="margin: 0">Owner</h3>
      </div>
      <div class="column is-3">
        <h3 style="margin: 0">Report Group</h3>
      </div>
      <div class="column is-3">
        <h3 style="margin: 0">Data Type</h3>
      </div>
    </div>
  </div>

  <div *ngIf="reports.length > 0">
    <div *ngFor="let report of reports" class="card">
      <div class="columns">
        <div class="column is-3">
          <h3 style="margin: 0">{{ report.name }}</h3>
        </div>
        <div class="column is-3">
          <b style="margin: 0">{{ (userService.formatUser(report.ownerUserId) | async) == "James Gaunt" ? "System" : (userService.formatUser(report.ownerUserId) | async) }}</b>
        </div>
        <div class="column is-3">
          <b style="margin: 0">{{ (reportGroupLookup.get({ id: report.reportGroupId }) | async)?.name }}</b>
        </div>
        <div class="column is-3">
          <b style="margin: 0">{{ (reportProviderLookup.get({ id: report.reportProviderId }) | async)?.name }}</b>
        </div>
      </div>
      <p style="margin: 8px 0 8px 0">{{ report.description }}&nbsp;</p>
      <div class="columns">
        <div class="column">
          <b>Created:</b> {{ report.createdAt | date: 'dd/MM/yyyy' }} &nbsp;|&nbsp;
          <span *ngIf="report.isPublic" class="text is-success is-bold">Public</span>
          <span *ngIf="!report.isPublic" class="text is-warning is-bold">Private</span>
        </div>
        <div class="column">
          <div class="text is-right-aligned">
            <a *ngIf="canEditReport(report)" class="link is-primary" (click)="edit(report)">edit</a> &nbsp;
            <a class="link is-success" (click)="copy(report)">copy</a> &nbsp;
            <a class="link is-warning" (click)="run(report)">run</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="reports.length == 0">
    <p>No reports found.</p>
  </div>



  <!--
  <grid [dataSource]="reportApi" [filterForm]="filterForm">
    <grid-column name="name" />
    <grid-reference-column name="reportGroupId" [dataSource]="reportGroupApi" />
    <grid-column name="owner">
      <ng-template #itemTemplate let-item>
        {{ (userService.formatUser(item.ownerUserId) | async) == "James Gaunt" ? "System" : (userService.formatUser(item.ownerUserId) | async) }}
      </ng-template>
    </grid-column>
    <grid-reference-column name="reportProviderId" label="Data Type" [dataSource]="staticDataCache.reportProvider" />
    <grid-boolean-column name="isPublic" label="Public" />
    <grid-column justify="right">
      <ng-template #itemTemplate let-item>
        <a *ngIf="canEditReport(item)" class="link is-primary" (click)="edit(item)">edit</a>
        &nbsp;
        <a class="link is-success" (click)="copy(item)">copy</a>
        &nbsp;
        <a class="link is-warning" (click)="run(item)">run</a>

      </ng-template>
      <ng-template #headTemplate>
        <a class="link is-success" (click)="add()">add</a>
      </ng-template>
    </grid-column>
  </grid>
  -->
</div>



