<ul class="breadcrumbs">
  <li><a routerLink="/home">Home</a></li>
  <li><a routerLink="/project/project-list">Projects</a></li>
  <li><a routerLink="/project/project-item/{{ item.id }}">Project</a></li>
</ul>
<div class="container">
  <project-tabs></project-tabs>
  <div class="columns">
    <div class="column">
      <h3 style="margin-top: 0">Open Team Support Requests</h3>
    </div>
    <div class="column is-right">
      <a class="link is-primary">show historic/completed requests</a>
    </div>
  </div>
  <div class="flex">
    <div class="is-12">
      <div *ngIf="items === null">
        <p>Loading...</p>
      </div>
      <div *ngIf="items !== null && items.length == 0">
        <div class="message is-primary">
          No team support has been requested for this project.
        </div>
      </div>
      <div *ngIf="items !== null && items.length > 0" class="project-support-list">
        <div class="project-support" *ngFor="let teamSupport of items">
          <div class="header">
            <div class="date">
              <div class="columns">
                <div class="column">
                  {{ teamSupport.createdAt | date: 'dd-MMM-yy HH:mm' }}:
                  Support requested by
                  {{ (userLookup.get({ id: teamSupport.createdById }) | async)?.fullName }}
                  from
                  {{ (teamLookup.get({ id: teamSupport.supportTeamId }) | async)?.name }}
                </div>
                <div class="column is-right">
                  <button class="button is-small is-danger" (click)="deleteProjectTeamSupport(teamSupport)">delete</button>
                </div>
              </div>
            </div>
          </div>
          <pre class="description">{{ teamSupport.createdNotes }}</pre>
          <div *ngIf="teamSupport.completedAt === null" class="footer">
            <div class="columns">
              <div class="column is-right">
                <button class="button is-small is-primary" (click)="completeProjectTeamSupport(teamSupport)">mark as complete</button>
              </div>
            </div>
          </div>
          <div *ngIf="teamSupport.completedAt !== null" class="footer">
            <div class="teams">
              {{ teamSupport.completedAt | date: 'dd-MMM-yy HH:mm' }}:
              Marked as completed by
              {{ (userLookup.get({ id: teamSupport.completedById || '' }) | async)?.fullName }}
            </div>
            <pre *ngIf="teamSupport.completedNotes" class="description">{{ teamSupport.completedNotes }}</pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="floating-buttons">
    <button class="button" (click)="cancel()">Close</button>
  </div>
</div>
