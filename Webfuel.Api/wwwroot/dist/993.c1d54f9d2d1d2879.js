"use strict";(self.webpackChunkWebfuel_App=self.webpackChunkWebfuel_App||[]).push([[993],{7147:(y,b,a)=>{a.d(b,{I:()=>C});var t=a(7003),r=a(9212);const p=["headTemplate"],c=["itemTemplate"];function x(d,T){if(1&d&&r._uU(0),2&d){const _=T.$implicit,l=r.oxw();r.hij(" ",_[l.name],"\n")}}let C=(()=>{class d{constructor(){this.name="",this.justify="left",this._sortable=!0,this.grid=null}get label(){return null==this._label&&(this._label=t.Z.splitCamelCase(this.name),this._label.endsWith(" Id")&&(this._label=this._label.substring(0,this._label.length-3))),this._label}set label(_){this._label=_}get sortable(){return!(!this.grid||this.grid.sortable)&&this._sortable}set sortable(_){this._sortable=_}get headTemplateRef(){return this.customHeadTemplate?this.customHeadTemplate:this.textHeadTemplate}get itemTemplateRef(){return this.customItemTemplate?this.customItemTemplate:this.textItemTemplate}get direction(){return this.grid?this.grid.columnDirection(this):0}static#t=this.\u0275fac=function(l){return new(l||d)};static#e=this.\u0275cmp=r.Xpm({type:d,selectors:[["grid-column"]],contentQueries:function(l,f,m){if(1&l&&(r.Suo(m,p,5),r.Suo(m,c,7)),2&l){let h;r.iGM(h=r.CRH())&&(f.customHeadTemplate=h.first),r.iGM(h=r.CRH())&&(f.customItemTemplate=h.first)}},viewQuery:function(l,f){if(1&l&&(r.Gf(p,5),r.Gf(c,7)),2&l){let m;r.iGM(m=r.CRH())&&(f.textHeadTemplate=m.first),r.iGM(m=r.CRH())&&(f.textItemTemplate=m.first)}},inputs:{name:"name",label:"label",justify:"justify",sortable:"sortable"},decls:2,vars:0,consts:[["itemTemplate",""]],template:function(l,f){1&l&&r.YNc(0,x,1,1,"ng-template",null,0,r.W1O)},encapsulation:2})}return d})()},3993:(y,b,a)=>{a.d(b,{M:()=>N});var t=a(9212),r=a(7147),p=a(7003),c=a(95),x=a(3620),C=a(1993),d=a(9708),T=a(6814),_=a(6236);function l(i,s){if(1&i&&(t.TgZ(0,"form",7),t._UZ(1,"input",8),t.qZA()),2&i){const e=t.oxw();t.Q6J("formGroup",e.searchForm)}}function f(i,s){1&i&&t._UZ(0,"th",9)}function m(i,s){1&i&&t.GkF(0)}function h(i,s){1&i&&(t.TgZ(0,"span"),t._UZ(1,"i",13),t.qZA())}function Z(i,s){1&i&&(t.TgZ(0,"span"),t._UZ(1,"i",14),t.qZA())}function v(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"a",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,u=t.oxw();return t.KtG(u.columnSort(n))}),t._uU(1),t.YNc(2,h,2,0,"span",5)(3,Z,2,0,"span",5),t.qZA()}if(2&i){const e=t.oxw(2).$implicit;t.xp6(),t.hij(" ",e.label," "),t.xp6(),t.Q6J("ngIf",e.direction>0),t.xp6(),t.Q6J("ngIf",e.direction<0)}}function I(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2).$implicit;t.xp6(),t.Oqu(e.label)}}function q(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,v,4,3,"a",11)(2,I,2,1,"span",5),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(),t.Q6J("ngIf",e.sortable),t.xp6(),t.Q6J("ngIf",!e.sortable)}}function G(i,s){if(1&i&&(t.TgZ(0,"th"),t.YNc(1,m,1,0,"ng-container",10)(2,q,3,2,"div",5),t.qZA()),2&i){const e=s.$implicit;t.Udp("text-align",e.justify),t.xp6(),t.Q6J("ngTemplateOutlet",e.headTemplateRef),t.xp6(),t.Q6J("ngIf",!e.headTemplateRef)}}function k(i,s){1&i&&t._UZ(0,"i",22)}function A(i,s){1&i&&t._UZ(0,"i",23)}function J(i,s){if(1&i&&(t.TgZ(0,"td",19),t.YNc(1,k,1,0,"i",20)(2,A,1,0,"i",21),t.qZA()),2&i){const e=t.oxw(3);t.xp6(),t.Q6J("ngIf",!e.sorting),t.xp6(),t.Q6J("ngIf",e.sorting)}}function Q(i,s){1&i&&t.GkF(0)}const D=i=>({$implicit:i});function U(i,s){if(1&i&&(t.TgZ(0,"td"),t.YNc(1,Q,1,0,"ng-container",24),t.qZA()),2&i){const e=s.$implicit,o=t.oxw().$implicit;t.Udp("text-align",e.justify),t.xp6(),t.Q6J("ngTemplateOutlet",e.itemTemplateRef)("ngTemplateOutletContext",t.VKq(4,D,o))}}function O(i,s){if(1&i&&(t.TgZ(0,"tr",17),t.YNc(1,J,3,2,"td",18)(2,U,2,6,"td",3),t.qZA()),2&i){const e=t.oxw(2);t.xp6(),t.Q6J("ngIf",e.sortable),t.xp6(),t.Q6J("ngForOf",e.columns)}}function E(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"tbody",15),t.NdJ("cdkDropListDropped",function(n){t.CHM(e);const u=t.oxw();return t.KtG(u.drop(n))}),t.YNc(1,O,3,2,"tr",16),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("cdkDropListDisabled",!e.sortable),t.xp6(),t.Q6J("ngForOf",e.items)}}function F(i,s){if(1&i&&(t.TgZ(0,"tbody")(1,"tr")(2,"td")(3,"i"),t._uU(4,"No items to display"),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(2),t.uIk("colspan",e.columnCount)}}function M(i,s){if(1&i&&(t.TgZ(0,"tbody")(1,"tr")(2,"td"),t._uU(3," Loading... "),t.qZA()()()),2&i){const e=t.oxw();t.xp6(2),t.uIk("colspan",e.columnCount)}}function w(i,s){1&i&&t._UZ(0,"div")}function L(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",34),t.NdJ("click",function(){const u=t.CHM(e).$implicit,g=t.oxw(3);return t.KtG(g.repage(u))}),t._uU(1),t.qZA()}if(2&i){const e=s.$implicit,o=t.oxw(3);t.Q6J("disabled",o.pageIndex==e),t.xp6(),t.Oqu(e+1)}}function K(i,s){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,L,2,2,"button",33),t.qZA()),2&i){const e=t.oxw(2);t.xp6(),t.Q6J("ngForOf",e.range(e.pageCount))}}function S(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",35)(1,"button",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.repage(0))}),t._uU(2,"First"),t.qZA(),t.TgZ(3,"button",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.repage(n.pageIndex-1))}),t._uU(4,"\xab"),t.qZA(),t.TgZ(5,"button",36),t._uU(6),t.qZA(),t.TgZ(7,"button",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.repage(n.pageIndex+1))}),t._uU(8,"\xbb"),t.qZA(),t.TgZ(9,"button",34),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.repage(n.pageCount-1))}),t._uU(10,"Last"),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(),t.Q6J("disabled",e.pageIndex<=0),t.xp6(2),t.Q6J("disabled",e.pageIndex<=0),t.xp6(3),t.Oqu(e.pageIndex+1),t.xp6(),t.Q6J("disabled",e.pageIndex>=e.pageCount-1),t.xp6(2),t.Q6J("disabled",e.pageIndex>=e.pageCount-1)}}function R(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",25)(1,"div",26)(2,"div",27),t.YNc(3,w,1,0,"div",5)(4,K,2,1,"div",5)(5,S,11,5,"div",28),t.qZA(),t.TgZ(6,"div",29)(7,"select",30),t.NdJ("change",function(n){t.CHM(e);const u=t.oxw();return t.KtG(u.retake(n))}),t._UZ(8,"option",31),t.TgZ(9,"option",32),t._uU(10,"5"),t.qZA(),t.TgZ(11,"option",32),t._uU(12,"10"),t.qZA(),t.TgZ(13,"option",32),t._uU(14,"15"),t.qZA(),t.TgZ(15,"option",32),t._uU(16,"20"),t.qZA(),t.TgZ(17,"option",32),t._uU(18,"25"),t.qZA(),t.TgZ(19,"option",32),t._uU(20,"30"),t.qZA(),t.TgZ(21,"option",32),t._uU(22,"40"),t.qZA(),t.TgZ(23,"option",32),t._uU(24,"50"),t.qZA(),t.TgZ(25,"option",32),t._uU(26,"100"),t.qZA()(),t._uU(27),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.pageCount<=1),t.xp6(),t.Q6J("ngIf",e.pageCount>1&&e.pageCount<=12),t.xp6(),t.Q6J("ngIf",e.pageCount>12),t.xp6(4),t.Q6J("selected",5==e.query.take),t.xp6(2),t.Q6J("selected",10==e.query.take),t.xp6(2),t.Q6J("selected",15==e.query.take),t.xp6(2),t.Q6J("selected",20==e.query.take),t.xp6(2),t.Q6J("selected",25==e.query.take),t.xp6(2),t.Q6J("selected",30==e.query.take),t.xp6(2),t.Q6J("selected",40==e.query.take),t.xp6(2),t.Q6J("selected",50==e.query.take),t.xp6(2),t.Q6J("selected",100==e.query.take),t.xp6(2),t.hij(" / ",e.totalCount," ")}}let N=(()=>{class i{constructor(e,o){this.cd=e,this.queryService=o,this.destroyRef=(0,t.f3M)(t.ktI),this.filterForm=null,this.filter=new t.vpe,this.search=!1,this.stateKey="",this.searchForm=new c.cw({search:new c.NI("",{nonNullable:!0})}),this.query={skip:0,take:10,sort:[],filters:[],projection:[],search:""},this.items=[],this.totalCount=-1,this.columns=[],this.pageIndex=0,this.pageCount=0,this.sorting=!1}fetch(){if(this.dataSource){this.sortable&&(this.query.skip=0,this.query.take=100);var e=this.buildQuery();this.dataSource.query(e).subscribe(o=>{if(o.totalCount>0&&0===o.items.length&&this.query.skip>0)return this.query.skip=0,void this.fetch();this.saveState(),this.sorting=!1,this.items=o.items,this.totalCount=o.totalCount,this.calculatePage(),this.cd.detectChanges()})}}buildQuery(){var e=this.query;return this.filterForm&&(e=p.Z.merge(e,this.filterForm.getRawValue())),this.search&&(e=p.Z.merge(e,this.searchForm.getRawValue())),this.filter&&this.filter.emit(e),e}get columnCount(){return this.columns.length+(this.sortable?1:0)}saveState(){if(this.stateKey){var e={query:this.query};this.filterForm&&(e.filterForm=this.filterForm.getRawValue()),console.log("Saving Grid State: "+this.stateKey,e),p.Z.setLocalStorage("GridState:"+this.stateKey,e,86400)}}loadState(){if(this.stateKey){var e=p.Z.getLocalStorage("GridState:"+this.stateKey);!e||!e.query||(console.log("Loaded Grid State: "+this.stateKey,e),this.query=e.query,(e.filterForm||this.filterForm)&&this.filterForm?.patchValue(e.filterForm,{emitEvent:!1}))}}range(e){return p.Z.range(e)}calculatePage(){this.query.take<=0?(this.pageIndex=0,this.pageCount=1):(this.pageIndex=Math.floor(this.query.skip/this.query.take),this.pageCount=Math.ceil(this.totalCount/this.query.take))}repage(e){this.query.skip=this.query.take*e,this.fetch()}retake(e){this.query.skip=0,this.query.take=parseInt(e.target.value,10),this.fetch()}get sortable(){return this.dataSource&&this.dataSource.sort}drop(e){if(!this.sortable||this.sorting)return;this.sorting=!0;var o=e.currentIndex;const u=this.items.splice(e.previousIndex,1);this.items.splice(o,0,u[0]),this.dataSource.sort({ids:p.Z.map(this.items,g=>g.id)}).subscribe()}columnSort(e){this.queryService.sortToggle(this.query,e.name),this.fetch()}columnDirection(e){return this.queryService.sortDirection(this.query,e.name)}ngAfterViewInit(){this.loadState(),this.columns=this.columnQuery.toArray(),p.Z.forEach(this.columns,e=>{e.grid=this}),this.dataSource&&this.dataSource.changed&&this.dataSource.changed.pipe((0,x.b)(250),(0,C.sL)(this.destroyRef)).subscribe(()=>this.fetch()),this.filterForm&&this.filterForm.valueChanges.pipe((0,x.b)(200),(0,C.sL)(this.destroyRef)).subscribe(()=>this.fetch()),this.search&&this.searchForm.valueChanges.pipe((0,x.b)(250),(0,C.sL)(this.destroyRef)).subscribe(()=>this.fetch()),this.fetch(),this.cd.detectChanges()}static#t=this.\u0275fac=function(o){return new(o||i)(t.Y36(t.sBO),t.Y36(d._))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["grid"]],contentQueries:function(o,n,u){if(1&o&&t.Suo(u,r.I,4),2&o){let g;t.iGM(g=t.CRH())&&(n.columnQuery=g)}},inputs:{dataSource:"dataSource",filterForm:"filterForm",search:"search",stateKey:"stateKey"},outputs:{filter:"filter"},decls:11,vars:7,consts:[["class","form",3,"formGroup",4,"ngIf"],[1,"table"],["class","is-narrow",4,"ngIf"],[3,"text-align",4,"ngFor","ngForOf"],["cdkDropList","","cdkDropListLockAxis","y",3,"cdkDropListDisabled","cdkDropListDropped",4,"ngIf"],[4,"ngIf"],["class","table-pager",4,"ngIf"],[1,"form",3,"formGroup"],["type","text","placeholder","Search...","formControlName","search",1,"input"],[1,"is-narrow"],[4,"ngTemplateOutlet"],["class","data-sorter","href","javascript:;",3,"click",4,"ngIf"],["href","javascript:;",1,"data-sorter",3,"click"],[1,"fas","fa-sort-amount-down-alt"],[1,"fas","fa-sort-amount-down"],["cdkDropList","","cdkDropListLockAxis","y",3,"cdkDropListDisabled","cdkDropListDropped"],["cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag",""],["class","drag-handle is-narrow","cdkDragHandle","",4,"ngIf"],["cdkDragHandle","",1,"drag-handle","is-narrow"],["class","fas fa-fw fa-bars",4,"ngIf"],["class","fas fa-fw fa-spin fa-sync",4,"ngIf"],[1,"fas","fa-fw","fa-bars"],[1,"fas","fa-fw","fa-spin","fa-sync"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"table-pager"],[1,"columns","is-mobile"],[1,"column"],["class","buttons",4,"ngIf"],[1,"column","is-right"],[2,"text-align","right","background-color","transparent","border","0",3,"change"],[2,"display","none"],[3,"selected"],["class","button is-primary is-small",3,"disabled","click",4,"ngFor","ngForOf"],[1,"button","is-primary","is-small",3,"disabled","click"],[1,"buttons"],[1,"button","is-primary","is-small",3,"disabled"]],template:function(o,n){1&o&&(t.YNc(0,l,2,1,"form",0),t.TgZ(1,"div",1)(2,"table")(3,"thead")(4,"tr"),t.YNc(5,f,1,0,"th",2)(6,G,3,4,"th",3),t.qZA()(),t.YNc(7,E,2,2,"tbody",4)(8,F,5,1,"tbody",5)(9,M,4,1,"tbody",5),t.qZA()(),t.YNc(10,R,28,13,"div",6)),2&o&&(t.Q6J("ngIf",n.search),t.xp6(5),t.Q6J("ngIf",n.sortable),t.xp6(),t.Q6J("ngForOf",n.columns),t.xp6(),t.Q6J("ngIf",n.totalCount>0),t.xp6(),t.Q6J("ngIf",0==n.totalCount),t.xp6(),t.Q6J("ngIf",n.totalCount<0),t.xp6(),t.Q6J("ngIf",n.totalCount>n.items.length))},dependencies:[T.sg,T.O5,T.tP,c._Y,c.YN,c.Kr,c.Fj,c.JJ,c.JL,c.sg,c.u,_.Wj,_.Zt,_.Bh],encapsulation:2,changeDetection:0})}return i})()}}]);