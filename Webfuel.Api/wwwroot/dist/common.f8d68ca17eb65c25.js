"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[76],{9438:(d,c,n)=>{n.d(c,{J:()=>i});var p=n(1626),t=n(4438),r=n(8304),_=n(7520),m=n(4309),a=n(5045),l=n(5312);class i extends _.V{constructor(){super(),this.httpClient=(0,t.WQX)(p.Qq),this.projectSupportApi=(0,t.WQX)(r.n),this.uploadProjectSupportFilesDialog=(0,t.WQX)(a.d),this.attachProjectSupportFilesDialog=(0,t.WQX)(m.n),this.existingFiles=[],this.uploadedFiles=[],this.submitting=!1,this.progress=null}addUploadedFiles(){this.uploadProjectSupportFilesDialog.open({projectSupportGroupId:this.data.projectSupportGroupId}).subscribe(s=>{s.uploadedFiles.forEach(e=>{var u=this.uploadedFiles.findIndex(f=>f.name==e.name);u>=0?this.uploadedFiles[u]=e:this.uploadedFiles.push(e)})})}addAttachedFiles(){this.projectSupportApi.selectFile({projectSupportGroupId:this.data.projectSupportGroupId}).subscribe(s=>{this.attachProjectSupportFilesDialog.open({databaseFiles:s,existingFiles:this.existingFiles}).subscribe(e=>{this.existingFiles=e.existingFiles})})}removeUploadedFile(s,e){e.preventDefault(),e.stopPropagation();var u=this.uploadedFiles.indexOf(s);-1!==u&&this.uploadedFiles.splice(u,1)}removeExistingFile(s,e){e.preventDefault(),e.stopPropagation();var u=this.existingFiles.indexOf(s);-1!==u&&this.existingFiles.splice(u,1)}submitFiles(){var s=this.toFormData();null!=s?this.httpClient.post(l.c.apiHost+"api/project-support/upload-file",s,{reportProgress:!0,observe:"events"}).subscribe({next:e=>{if(e.type===p.hv.UploadProgress&&e.total&&(this.progress=Math.round(100*e.loaded/e.total)),e.type===p.hv.Response){console.log(e);var u=e.body;this.uploadedFiles=[],this.existingFiles=this.existingFiles.concat(u),this.submitForm()}},error:e=>{this.fileSubmissionError(e)}}):this.submitForm()}toFormData(){if(!this.uploadedFiles||!this.uploadedFiles.length)return null;const s=new FormData;for(var e=0;e<this.uploadedFiles.length;e++)s.append("file_"+e,this.uploadedFiles[e]);return s.append("data",JSON.stringify({projectSupportGroupId:this.data.projectSupportGroupId})),s}fileSubmissionError(s){this.submitting=!1,this.progress=null,console.log("File Submission Error: ",s),alert("There was an error uploading your files.\n\nPlease ensure all files are saved on your computer, and not open in another application.")}}},1512:(d,c,n)=>{n.d(c,{s:()=>l});var p=n(1435),t=n(4438),r=n(177);function _(i,o){1&i&&t.nrm(0,"span",3)}function m(i,o){1&i&&t.nrm(0,"span",4)}function a(i,o){if(1&i&&t.DNE(0,_,1,0,"span",1)(1,m,1,0,"span",2),2&i){const s=o.$implicit,e=t.XpG();t.Y8G("ngIf",s[e.name]),t.R7$(),t.Y8G("ngIf",!s[e.name])}}let l=(()=>{class i extends p.C{constructor(){super(),this.justify="center"}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["grid-boolean-column"]],features:[t.Jv_([{provide:p.C,useExisting:i}]),t.Vt3],decls:2,vars:0,consts:[["itemTemplate",""],["class","fas fa-check",4,"ngIf"],["class","fas fa-times","style","opacity: 0.2;",4,"ngIf"],[1,"fas","fa-check"],[1,"fas","fa-times",2,"opacity","0.2"]],template:function(e,u){1&e&&t.DNE(0,a,2,2,"ng-template",null,0,t.C5r)},dependencies:[r.bT],encapsulation:2})}}return i})()},1050:(d,c,n)=>{n.d(c,{u:()=>m});var p=n(1435),t=n(4438),r=n(177);function _(a,l){if(1&a&&(t.EFF(0),t.nI1(1,"date")),2&a){const i=l.$implicit,o=t.XpG();t.SpI(" ",t.i5U(1,1,i[o.name],"dd MMM yyyy"),"\n")}}let m=(()=>{class a extends p.C{static{this.\u0275fac=(()=>{let i;return function(s){return(i||(i=t.xGo(a)))(s||a)}})()}static{this.\u0275cmp=t.VBU({type:a,selectors:[["grid-date-column"]],features:[t.Jv_([{provide:p.C,useExisting:a}]),t.Vt3],decls:2,vars:0,consts:[["itemTemplate",""]],template:function(o,s){1&o&&t.DNE(0,_,2,4,"ng-template",null,0,t.C5r)},dependencies:[r.vh],encapsulation:2})}}return a})()},8009:(d,c,n)=>{n.d(c,{R:()=>m});var p=n(1435),t=n(4438),r=n(177);function _(a,l){if(1&a&&(t.EFF(0),t.nI1(1,"number")),2&a){const i=l.$implicit,o=t.XpG();t.Lme(" ",o.prefix,"",t.i5U(1,2,i[o.name],o.format),"\n")}}let m=(()=>{class a extends p.C{constructor(){super(),this.format="1.0-0",this.prefix="",this.justify="right"}static{this.\u0275fac=function(o){return new(o||a)}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["grid-number-column"]],inputs:{format:"format",prefix:"prefix"},features:[t.Jv_([{provide:p.C,useExisting:a}]),t.Vt3],decls:2,vars:0,consts:[["itemTemplate",""]],template:function(o,s){1&o&&t.DNE(0,_,2,5,"ng-template",null,0,t.C5r)},dependencies:[r.QX],encapsulation:2})}}return a})()},9779:(d,c,n)=>{n.d(c,{h:()=>a});var p=n(1435),t=n(4412),r=n(4438),_=n(177);function m(l,i){if(1&l&&(r.EFF(0),r.nI1(1,"async")),2&l){const o=i.$implicit,s=r.XpG();r.SpI(" ",s.format(r.bMT(1,1,s.lookup(o[s.name]))),"\n")}}let a=(()=>{class l extends p.C{constructor(){super(...arguments),this._cache={}}lookup(o){if(null==this._cache[o]){if(this._cache[o]=new t.t(null),!this.dataSource)return new t.t(null);this.dataSource.query({skip:0,take:1,filters:[{field:"id",op:"eq",value:o}]}).subscribe(s=>{1==s.items.length&&this._cache[o].next(s.items[0])})}return this._cache[o]}format(o){return o?o.name:""}static{this.\u0275fac=(()=>{let o;return function(e){return(o||(o=r.xGo(l)))(e||l)}})()}static{this.\u0275cmp=r.VBU({type:l,selectors:[["grid-reference-column"]],inputs:{dataSource:"dataSource"},features:[r.Jv_([{provide:p.C,useExisting:l}]),r.Vt3],decls:2,vars:0,consts:[["itemTemplate",""]],template:function(s,e){1&s&&r.DNE(0,m,2,3,"ng-template",null,0,r.C5r)},dependencies:[_.Jj],encapsulation:2})}}return l})()}}]);